# disp - Visualization & Display

Octave/MATLAB scripts for creating publication-quality visualizations of the analysis results.

## Purpose

Generate figures and plots for:
- **Lyapunov Exponent Analysis**: Visualize chaos indicators and sensitivity measures
- **Statistical Reports**: Period distributions, factorization patterns
- **Final Report**: Publication-ready figures

## Structure

```
disp/
├── plot_all.m                      # Master script - generates all figures
├── plot_lyapunov_vs_length.m       # Lambda vs sequence length scatter plot
├── plot_period_vs_lambda.m         # Period vs lambda (log scale)
├── plot_classification_pie.m       # Behavioral classification pie chart
├── plot_top_sequences.m            # Top N most chaotic sequences bar chart
├── figures/                        # Output directory for generated figures
└── README.md                       # This file
```

## Prerequisites

- **Octave 6.0+** or **MATLAB R2019+**
- Lyapunov analysis data from `obsv/` (run analysis first)

### Installing Octave

**Ubuntu/Debian**:
```bash
sudo apt install octave
```

**macOS**:
```bash
brew install octave
```

**Arch Linux**:
```bash
sudo pacman -S octave
```

## Usage

### Generate All Figures

The easiest way is to use the master script:

```octave
cd disp
octave plot_all.m
```

Or from within Octave:

```octave
cd disp
plot_all()
```

This generates all figures in `disp/figures/`:
- `lyapunov_vs_length.png`
- `period_vs_lambda.png`
- `classification_pie.png`
- `top_chaotic_sequences.png`

### Custom Data File

If your Lyapunov data is in a different location:

```octave
plot_all('../path/to/lyapunov_data.csv')
```

### Custom Output Directory

Specify both data file and output directory:

```octave
plot_all('../obsv/logs/lyapunov_data.csv', 'my_figures')
```

### Individual Plots

Generate specific plots individually:

```octave
% Lambda vs length
plot_lyapunov_vs_length('../obsv/logs/lyapunov_data.csv', 'figures/lambda_length.png')

% Period vs lambda
plot_period_vs_lambda('../obsv/logs/lyapunov_data.csv', 'figures/period_lambda.png')

% Classification pie chart
plot_classification_pie('../obsv/logs/lyapunov_data.csv', 'figures/pie.png')

% Top 10 sequences
plot_top_sequences('../obsv/logs/lyapunov_data.csv', 'figures/top10.png', 10)
```

## Data Requirements

The scripts expect CSV data with the following columns (generated by `obsv/lyapunov.py`):

| Column | Type | Description |
|--------|------|-------------|
| sequence | string | Move sequence (e.g., "FR → UF") |
| sequence_length | int | Number of moves |
| base_period | int | Period of base sequence |
| lyapunov_exponent | float | Discrete Lyapunov exponent λ |
| classification | string | "regular", "sensitive", or "chaotic" |
| perturbations_tested | int | Number of perturbations |
| mean_ratio | float | Mean period ratio |
| std_ratio | float | Std dev of ratios |
| max_ratio | float | Maximum ratio observed |
| mean_divergence | float | Mean absolute divergence |
| max_divergence | float | Maximum divergence |

## Workflow

1. **Run Analysis** (in `obsv/`):
   ```bash
   cd ../obsv
   uv run python scripts/run_lyapunov.py --from-logs --max-sequences 10
   ```

2. **Generate Figures** (in `disp/`):
   ```bash
   cd ../disp
   octave plot_all.m
   ```

3. **View Results**:
   ```bash
   ls figures/
   # Open PNG files in your image viewer
   ```

## Figure Descriptions

### 1. Lyapunov Exponent vs Sequence Length

**File**: `lyapunov_vs_length.png`

Scatter plot showing how λ varies with sequence length. Color-coded by classification:
- **Blue**: Regular (λ < 0.1)
- **Orange**: Sensitive (0.1 ≤ λ < ln 2)
- **Red**: Chaotic (λ ≥ ln 2)

Includes threshold lines at λ = 0.1 and λ = ln(2) ≈ 0.69.

### 2. Period vs Lyapunov Exponent

**File**: `period_vs_lambda.png`

Log-scale scatter plot investigating correlation between base period and sensitivity. Shows whether longer periods tend to be more chaotic.

### 3. Classification Pie Chart

**File**: `classification_pie.png`

Pie chart showing percentage distribution of sequences across behavioral classifications. Useful for summary statistics.

### 4. Top Chaotic Sequences

**File**: `top_chaotic_sequences.png`

Horizontal bar chart of the N sequences with highest Lyapunov exponents. Shows which move combinations are most sensitive to perturbations.

## Customization

All plotting functions accept parameters for customization:

```octave
% Change number of top sequences shown
plot_top_sequences(data_file, output_file, 15)  % Show top 15

% Modify colors in scripts
% Edit the 'colors' struct in each .m file:
colors = struct('regular', [R, G, B], ...
               'sensitive', [R, G, B], ...
               'chaotic', [R, G, B]);
```

## Output Quality

All figures are generated at:
- **Resolution**: 300 DPI (publication quality)
- **Format**: PNG (easy to include in LaTeX/Markdown)
- **Size**: 800x600 or 900x700 pixels

For other formats (PDF, EPS, SVG):

```octave
% Modify the print command in each script:
print(output_file, '-dpdf');  % PDF
print(output_file, '-deps');  % EPS
print(output_file, '-dsvg');  % SVG
```

## Troubleshooting

### "Cannot open file" error

Make sure you've run the Lyapunov analysis first:
```bash
cd ../obsv
uv run python scripts/run_lyapunov.py
```

### Graphics issues in Octave

If plots don't display or save correctly:

```octave
% Set graphics toolkit
graphics_toolkit('gnuplot')  % or 'qt' or 'fltk'

% Check available toolkits
available_graphics_toolkits()
```

### Permission errors

Make sure `figures/` directory is writable:
```bash
mkdir -p figures
chmod 755 figures
```

## Integration with Report

Include figures in LaTeX:

```latex
\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{../disp/figures/lyapunov_vs_length.png}
    \caption{Discrete Lyapunov exponent vs sequence length for 4D hypercube trajectories}
    \label{fig:lyapunov-length}
\end{figure}
```

Or in Markdown:

```markdown
![Lyapunov vs Length](disp/figures/lyapunov_vs_length.png)
```

## Mathematical Background

These visualizations illustrate the discrete Lyapunov exponent:

$$\lambda(S) = \frac{1}{n} \sum_{i=1}^{n} \log\left|\frac{\text{Period}(S_i^\text{perturbed})}{\text{Period}(S)}\right|$$

- **λ > ln(2)**: Chaotic-like behavior (high sensitivity)
- **λ ≈ 0**: Regular behavior (stable under perturbations)

See `docs/mathematical_framework.md` Section 10.1 for detailed theory.
